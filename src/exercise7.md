# Docker

**Docker** - это программная платформа для быстрой разработки, тестирования и развертывания приложений.  
Docker упаковывает ПО в стандартизованные блоки, которые называются контейнерами. Каждый контейнер включает все необходимое для работы приложения: библиотеки, системные инструменты, код и среду исполнения. Это упрощает перенос приложения на другую инфраструктуру.  
Приложения работают только внутри контейнеров и не имеют доступа к основной операционной системе. Это повышает безопасность приложений:они не смогут случайно или умышленно навредить основной системе. Если приложение в контейнере завершится с ошибкой или зависнет, это никак не затронет основную ОС.  

## Для чего он используется?

Благодаря Docker можно быстро развертывать и масштабировать приложения в любой среде и сохранять уверенность в том, что код будет работать.  
Docker позволяет создавать контейнеры, автоматизировать их запуск и развертывание, управляет жизненным циклом. Он позволяет запускать множество контейнеров на одной хост-машине.
Преимущества использования Docker контейнеров:

- **Изоляция:** Контейнеры изолируют приложения друг от друга и от хост-системы, что уменьшает возможные конфликты между зависимостями и обеспечивает более надежную среду выполнения.  
- **Портативность:** Контейнеры могут быть созданы и запущены на различных системах без изменений, что делает развертывание приложений более простым и надежным.  
- **Эффективность использования ресурсов:** Контейнеры используют общие ресурсы операционной системы и разделяют ядро, что делает их более эффективными по сравнению с виртуальными машинами.  
-**Масштабируемость:** Контейнеры легко масштабируются горизонтально, позволяя быстро добавлять экземпляры приложения в ответ на увеличение нагрузки.  
-**Управление версиями:** Контейнеры позволяют управлять версиями приложений и их зависимостей, что упрощает процесс развертывания и обновления.  

## Чем Docker отличается от виртуальной машины?

**Контейнеры и виртуальные машины (ВМ)** — это методы изоляции приложений и окружений. Docker использует виртуализацию на уровне операционной системы, позволяя запускать приложения в изолированных контейнерах, которые делят ядро ОС с хост-системой. ВМ, напротив, создают полные виртуальные компьютеры с отдельными ОС и ресурсами.  
Это означает, что Docker-контейнеры более легкие, потому что они не требуют дублирования всей ОС, как ВМ. Контейнеры также быстрее запускаются и имеют меньший объем, что делает их более эффективными в ресурсоемких средах. Однако ВМ предоставляют большую изоляцию, так как каждая ВМ имеет свою собственную ОС и не зависит от хост-системы.  
Таким образом, Docker контейнеры предоставляют легковесное и быстрое решение для изоляции приложений, в то время как виртуальные машины обеспечивают более глубокую изоляцию за счет полной виртуализации.  
Различия между Docker контейнерами и виртуальными машинами.  
| Характеристика           | Docker контейнеры    | Виртуальные машины      |
|:------------------------:|:--------------------:|:-----------------------:|
| Уровень изоляции         | Операционная система | Аппаратное обеспечение  |
| Ресурсоемкость           | Меньше               | Больше                  |
| Запуск и остановка       | Быстрее              | Медленнее               |
| Размер                   | Меньше               | Больше                  |
| Изоляция                 | Менее глубокая       | Глубокая                |
| Нагрузка на хост-систему | Меньше               | Больше                  |
| Совместимость            | Ограниченная         | Высокая                 |
| Виртуализация ОС         | Да                   | Да                      |
| Гипервизор               | Не требуется         | Требуется               |

## Что такое Docker Compose?

**Docker-compose** - это средство для определения и запуска приложений Docker с несколькими контейнерами, которое позволяет разворачивать и настраивать их одновременно (одной командой), а без него пришлось бы разворачивать и настраивать каждый контейнер отдельно. Инструмент способен ускорить разработку: в многоконтейнерных приложениях количество контейнеров может доходить до нескольких десятков.  

## Что такое Kubernetes? Для чего он используется?

**Kubernetes(K8s)** — это программная платформа для автоматического управления контейнеризованными приложениями. Она предлагает базовые механизмы для их развертывания, масштабирования и поддержки. Система имеет открытый исходный код и быстро растущую экосистему.

Kubernetes используется для:

- **Наблюдение за работой сервисов.** Платформа позволяет следить как за отдельными приложениями, так и за всем кластером сразу. K8s имеет веб-интерфейс. Все данные о работе сервисов система предоставляет разработчику в интуитивно понятном виде.  

- **Распределение нагрузки.** Трафик, который потребляют контейнеры, может различаться. Это негативно влияет на развертывание приложений. Kubernetes автоматически отслеживает нагрузку в контейнерах, и если в каком-то из них обнаруживается высокий трафик, то платформа распределяет его между другими контейнерами.  

- **Оркестрация хранилища.** С помощью Kubernetes разработчик может выбрать систему хранения: локальное хранилище, облако и т.д. Платформа автоматически создаст ее и настроит под потребности проекта.  

- **Доставка трафика внутри кластера и маршрутизация между контейнерами.** При создании Kubernetes выделяет контейнеру IP-адрес, чтобы он мог «общаться» с другими контейнерами. Кроме того, существует такая абстракция, как сервис — просто зная имя сервиса, приложения внутри кластера могут обращаться друг к другу и обмениваться данными.  

- **Доставка трафика снаружи кластера.** Часто к запущенному на серверах приложению нужно обеспечить доступ какому-нибудь внешнему пользователю. K8s решает и этот вопрос с помощью Ingress.  

- **Разграничение доступа.(Безопасность и конфиденциальность)** У Kubernetes есть неймспейсы, которые позволяют делить окружение в рамках одного кластера. Можно раздавать права на неймспейсы или конкретные объекты, вводить политики безопасности, выделять неймспейсам конкретное количество ресурсов и заранее определять, с какими ресурсами будут запускаться контейнеры. Kubernetes может сохранять и контролировать конфиденциальные данные (пароли, ключи SSH, OAuth-токены), распределять права доступа к системе.

- **Взаимодействие контейнеров между собой.** По умолчанию все контейнеры в кластере открыты и могут свободно взаимодействовать друг с другом, что не безопасно. Без Kubernetes нужно применять файрвол или iptables, открывать отдельные порты на нодах и серверах и только к нужным ресурсам. В K8s iptables напрямую не используется, зато есть встроенные сетевые политики, которые позволяют контейнерам обращаться только к конкретным внешним ресурсам или другим контейнерам. Также можно настроить взаимодействие между неймспейсами — например, запретить стейджевым ходить в продовые и наоборот.  

- **Хранение данных.** Контейнеры — достаточно эфемерная штука, не рассчитанная на долгосрочное хранение данных. Чтобы это исправить, у Kubernetes есть Container Storage Interface, который позволяет подключать к контейнерам конкретные тома для считывания или записи данных. Причём если контейнер вдруг переедет на другую ноду, том с данными переедет за ним — K8s всё сделает сам.  

- **Развертывание и откаты.** Платформа позволяет развертывать приложения в автоматическом и ручном режимах. Есть вариант канареечного развертывания, когда изменения, внесенные разработчиком, применяются только на некоторой части контейнеров. Такое решение позволяет осторожно тестировать обновления. Изменения можно автоматически откатить.  

- **Самоконтроль.** Если контейнер отказывает или сбоит, Kubernetes автоматически перезапускает или останавливает его. Освободившиеся ресурсы она распределяет на другие приложения. Система контролирует их работу в соответствии с критериями, заданными разработчиком. Если контейнер не соответствует им, платформа отключает его или заменяет на другой, а также скрывает от клиента, пока он не будет готов к обслуживанию.  

- **Хранение и распространение конфигов.** Когда нужно запустить несколько инстансов одного и того же приложения, на каждый приходится доставлять один и тот же конфиг. Причём так, чтобы при изменении он обновился на уже запущенных инстансах. У Kubernetes для этой задачи есть инструмент Configmap, который всё делает автоматически. 
